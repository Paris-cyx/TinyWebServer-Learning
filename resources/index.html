<!DOCTYPE html>
<html>
    <head>
        <meta charset="UTF-8">
        <title>TinyWebServer - é¦–é¡µç™»å½•</title>
        <style>
            /* ç®€å•ç¾åŒ–ä¸€ä¸‹ï¼Œè®©ä½ çœ‹ç€èˆ’æœç‚¹ */
            body { background-color: #f0f2f5; font-family: sans-serif; display: flex; justify-content: center; align-items: center; height: 100vh; margin: 0; }
            .login-box { background: white; padding: 40px; border-radius: 10px; box-shadow: 0 0 20px rgba(0,0,0,0.1); text-align: center; width: 300px; }
            input { width: 100%; padding: 10px; margin: 10px 0; box-sizing: border-box; border: 1px solid #ccc; border-radius: 4px; }
            button { width: 100%; padding: 10px; background: #007bff; color: white; border: none; border-radius: 4px; cursor: pointer; font-size: 16px; }
            button:hover { background: #0056b3; }
            #msg { margin-top: 15px; font-weight: bold; min-height: 20px; }
            .success { color: green; }
            .error { color: red; }
        </style>
    </head>
    <body>
        <div class="login-box">
            <h2>ğŸ  é¦–é¡µç™»å½•</h2>
            
            <form id="loginForm">
                <input type="text" name="user" placeholder="è´¦å·" required>
                <input type="password" name="password" placeholder="å¯†ç " required>
                <button type="submit">ç«‹å³ç™»å½•</button>
            </form>
            
            <div id="msg"></div>
            
            <p><a href="/register.html" style="font-size: 12px; color: #666;">æ³¨å†Œæ–°è´¦å·</a></p>
        </div>

        <script>
            document.getElementById('loginForm').addEventListener('submit', function(e) {
                e.preventDefault(); // ğŸ›‘ é˜»æ­¢æµè§ˆå™¨è·³è½¬ï¼ˆé˜²æ­¢å‡ºç°ä½ åˆšæ‰çœ‹åˆ°çš„ JSON ç™½å±ï¼‰
                
                const msgDiv = document.getElementById('msg');
                msgDiv.innerText = "ç™»å½•ä¸­...";
                msgDiv.className = "";

                // 1. è·å–è¡¨å•æ•°æ®
                const formData = new URLSearchParams(new FormData(this));

                // 2. ç”¨ JS å‘é€è¯·æ±‚
                fetch('/2', { 
                    method: 'POST',
                    body: formData
                })
                .then(response => response.json()) // è§£æä½ åç«¯å‘æ¥çš„ JSON
                .then(data => {
                    console.log("Server Response:", data);

                    if (data.code === 200) {
                        // ç™»å½•æˆåŠŸ
                        msgDiv.innerText = "ğŸ‰ " + data.msg;
                        msgDiv.className = "success";
                        
                        // 1ç§’åè·³è½¬
                        setTimeout(() => {
                            window.location.href = data.url; 
                        }, 1000);
                    } else {
                        // ç™»å½•å¤±è´¥
                        msgDiv.innerText = "âš ï¸ " + data.msg;
                        msgDiv.className = "error";
                    }
                })
                .catch(error => {
                    console.error('Error:', error);
                    msgDiv.innerText = "è¿æ¥æœåŠ¡å™¨å¤±è´¥";
                    msgDiv.className = "error";
                });
            });
        </script>
    </body>
</html>